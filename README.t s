import { Given, When, Then } from '@cucumber/cucumber';
import { chromium, Browser, Page } from 'playwright';

let browser: Browser;
let page: Page;

Given('I am on the file upload page', async function() {
  browser = await chromium.launch({ headless: false });
  page = await browser.newPage();
  await page.goto('https://your-upload-page-url.com');  // Replace with your URL
});

When('I upload a file', async function() {
  const [fileChooser] = await Promise.all([
    page.waitForEvent('filechooser'),
    page.click('input[type="file"]') // Replace with your selector
  ]);

  await fileChooser.setFiles('path/to/your/file.txt');  // Replace with your file path
});

Then('I see the file uploaded successfully', async function() {
  const successMessage = await page.locator('your-success-message-selector').textContent();  // Replace with your selector
  if (successMessage !== 'Expected Success Message') {
    throw new Error('File upload failed');
  }

  await browser.close();
});
